<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!-- <h1>ğŸ’¡ Info</h1> -->
    <ul style="padding: 0;">
        <li><span id="daily-name"></span> <span class="count" id="daily"></span></li>
        <li>ë©˜í† ë§ <span class="count" id="mentor"></span></li>
        <li>í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ <span class="count" id="fri"></span></li>
        <li>ìœ„í´ë¦¬ í˜ì´í¼ <span class="count" id="sat"></span></li>
        <li><b>í”„ë¡ íŠ¸ì—”ë“œ ê¸°ì´ˆ í”„ë¡œì íŠ¸ </b><span class="count" id="prj"></span></li>
        <!-- <li class="f-12">ì§„ë„ ê¸°ë¡ ì‹œ â€˜ìŠ¤í”„ë¦°íŠ¸ ë¯¸ì…˜â€™ì€ ì§„í–‰ë„ì— ë”°ë¼ â€˜ë ˆìŠ¨â€™ ê°’ì„ 0~50ìœ¼ë¡œ ì§€ì •í•©ë‹ˆë‹¤.</li> -->
    </ul>
</body>
</html>

<style>
    @import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css");

    :root {
        
    }

    .f-12 { font-size: 12px; color: hsl(0, 0%, 60%); }
    body {
        font-family: 'Pretendard Variable';
        color: #555555;
        border: 1px #dcd0e9 solid;
        border-radius: 10px;
        padding: 2px 32px;
    }

    h1 {
        color: rgb(135, 0, 219)
    }

    li {
        line-height: 150%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 8px 0;
        font-weight: 500;
    }

    .count {
        background: rgb(247, 231, 255);
        border-radius: 100px;
        color: rgb(109, 0, 142);
        font-size: 14px;
        font-weight: 600;
        padding: 2px 14px;
    }

    b {
        background: linear-gradient(45deg, rgb(80, 24, 221) 0%, rgb(163, 31, 215) 100%);
        -webkit-background-clip: text;
        color: transparent;
    }
    
</style>

<script>
function getDday(daysArray, targetHour) {
    const now = new Date();
    
    // ì…ë ¥ ìœ íš¨ì„± ê²€ì‚¬
    if (!Array.isArray(daysArray) || daysArray.length !== 7 || daysArray.some(d => d !== 0 && d !== 1)) {
        throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ìš”ì¼ ë°°ì—´ì…ë‹ˆë‹¤.');
    }
    if (typeof targetHour !== 'number' || targetHour < 1 || targetHour > 24) {
        throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ì‹œê°„ì…ë‹ˆë‹¤.');
    }
    
    const adjustedHour = targetHour === 24 ? 0 : targetHour;
    const jsDay = now.getDay(); // 0(ì¼) ~ 6(í† )
    const currentArrayIndex = (jsDay - 1 + 7) % 7; // ìš”ì¼ ë°°ì—´ ì¸ë±ìŠ¤ (0: ì›”, 6: ì¼)
    
    let targetDate;
    
    if (daysArray[currentArrayIndex] === 1) {
        const targetToday = new Date(now);
        targetToday.setHours(adjustedHour, 0, 0, 0);
        
        if (targetToday > now) {
            targetDate = targetToday;
        } else {
            targetDate = findNextAllowedDay(now, daysArray, currentArrayIndex, adjustedHour);
        }
    } else {
        targetDate = findNextAllowedDay(now, daysArray, currentArrayIndex, adjustedHour);
    }
    
    function findNextAllowedDay(now, daysArray, currentArrayIndex, adjustedHour) {
        for (let i = 1; i <= 7; i++) {
            const nextArrayIndex = (currentArrayIndex + i) % 7;
            if (daysArray[nextArrayIndex] === 1) {
                const nextDate = new Date(now);
                nextDate.setDate(now.getDate() + i);
                nextDate.setHours(adjustedHour, 0, 0, 0);
                return nextDate;
            }
        }
        throw new Error('ê°€ëŠ¥í•œ ìš”ì¼ì´ ì—†ìŠµë‹ˆë‹¤.');
    }
    
    const diffInMs = targetDate - now;
    if (diffInMs < 0) return '0ì‹œê°„ 0ë¶„ 0ì´ˆ ë‚¨ìŒ';
    
    const diffInHours = diffInMs / (1000 * 60 * 60);
    if (diffInHours >= 24) {
        const days = Math.floor(diffInHours / 24);
        return `D-${days}`;
    } else {
        const diffInSeconds = Math.floor(diffInMs / 1000);
        const hours = Math.floor(diffInSeconds / 3600);
        const minutes = Math.floor((diffInSeconds % 3600) / 60);
        const seconds = diffInSeconds % 60;
        return `${hours}ì‹œê°„ ${minutes}ë¶„ ${seconds}ì´ˆ ë‚¨ìŒ`;
    }
}

function getTodayName(names, schedule, targetHour) {
    const now = new Date();
    const currentDay = now.getDay(); // 0(ì¼) ~ 6(í† )
    
    // í˜„ì¬ ë‚ ì§œì˜ ê¸°ì¤€ ì‹œê°„ ì„¤ì • (ì˜¤ëŠ˜ targetHour:00:00)
    const todayTargetTime = new Date(now);
    todayTargetTime.setHours(targetHour, 0, 0, 0);

    // ë§Œì•½ í˜„ì¬ ì‹œê°„ì´ ê¸°ì¤€ ì‹œê°„ë³´ë‹¤ ì´ì „ì´ë©´, ì´ì „ ë‚ ì„ ê¸°ì¤€ìœ¼ë¡œ í•´ì•¼ í•¨
    let dayIndex = currentDay;
    if (now < todayTargetTime) {
        dayIndex = (currentDay - 1 + 7) % 7; // í•˜ë£¨ ì „ ìš”ì¼ (ì¼ìš”ì¼ì´ë©´ í† ìš”ì¼ë¡œ)
    }

    // ì ìš©í•  ìš”ì¼ì´ ì•„ë‹ ê²½ìš°, ë‹¤ìŒ ì ìš© ìš”ì¼ ì°¾ê¸°
    while (schedule[dayIndex] === 0) {
        dayIndex = (dayIndex + 1) % 7; // ë‹¤ìŒ ë‚ ë¡œ ì´ë™
    }

    // ì´ë¦„ì„ ìˆœí™˜í•˜ë©´ì„œ í•´ë‹¹í•˜ëŠ” ì¸ë±ìŠ¤ë¥¼ ì°¾ìŒ
    const assignedIndex = dayIndex % names.length;
    
    return names[assignedIndex];
}

function getDaysUntil(year, month, day) {
    const today = new Date();
    const targetDate = new Date(year, month - 1, day); // monthëŠ” 0ë¶€í„° ì‹œì‘í•˜ë¯€ë¡œ -1

    const diffInMs = targetDate - today; // ë°€ë¦¬ì´ˆ ì°¨ì´ ê³„ì‚°
    const diffInDays = Math.ceil(diffInMs / (1000 * 60 * 60 * 24)); // ì¼ë¡œ ë³€í™˜

    return diffInDays >= 0 ? `D-${diffInDays}` : 0; // ë‚¨ì€ ì¼ì´ 0ì¼ ë¯¸ë§Œì´ë©´ 0 ë°˜í™˜
}

setInterval(() => {
    document.querySelector('#daily-name').innerHTML = `ë°ì¼ë¦¬ í€´ì¦ˆ - ${getTodayName(['ê¹€ìŠ¹ë¯¼', 'ê¹€í¬ì„±', 'ê°•í¬ì •', 'ì´ì§€ì€'], [1, 1, 1, 1, 1, 1, 0], 14)}`;
    document.querySelector('#daily').innerHTML = getDday([1, 1, 1, 1, 1, 1, 0], 14);
    document.querySelector('#fri').innerHTML = getDday([0, 0, 0, 0, 1, 0, 0], 14);
    document.querySelector('#mentor').innerHTML = getDday([0, 1, 0, 1, 0, 0, 0], 19);
    document.querySelector('#sat').innerHTML = getDday([0, 0, 0, 0, 0, 1, 0], 14);
    document.querySelector('#prj').innerHTML = getDaysUntil(2025, 3, 6);
}, 1000);
</script>
